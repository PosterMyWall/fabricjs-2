import{defineProperty as t}from"../../_virtual/_rollupPluginBabelHelpers.min.mjs";import{Group as e}from"./Group.min.mjs";import{classRegistry as s}from"../ClassRegistry.min.mjs";class r extends e{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),t(this,"rows",0),t(this,"columns",0),t(this,"layoutType",""),t(this,"alternateBackgroundColor1",null),t(this,"alternateBackgroundColor2",null),t(this,"highlightedRowsBackgroundColor",null),t(this,"highlightedRows",[]),t(this,"tableArray",[[]]),t(this,"ySpacing",0),t(this,"xSpacing",0),t(this,"fontSize",0),t(this,"hasButton",!0)}render(t){this._transformDone=!0,super.render(t),t.save(),this.transform(t),this.renderTableBorders(t),t.restore(),this._transformDone=!1}renderTableBorders(t){this.stroke&&0!==this.strokeWidth&&(t.save(),this._setStrokeStyles(t,this),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),this.isTableLayout()&&(this.drawColumnBorders(t),this.drawRowBorders(t)),t.restore())}isTable(){return!0}_renderBackground(t){if(0==this.highlightedRows.length&&(!this.alternateBackgroundColor1||!this.alternateBackgroundColor2)||!this.isTableLayout())return void super._renderBackground(t);const e=this.getTableBackGroundData();t.save();const s=this.getObjects();let r=null,i=null,o=!1;for(let h=0;h<e.length;h++)if(o=!1,"none"!=e[h]){if(null==r&&(r=0==h?-this.height/2:s[h].top-this.ySpacing/2),e[h]!=e[h+1])switch(i=Math.abs(r-s[h].top)+this.getHeightOfRow(h)+this.ySpacing/2,o=!0,e[h]){case"highlight":t.fillStyle=this.highlightedRowsBackgroundColor;break;case"color":t.fillStyle=this.backgroundColor;break;case"alternate1":t.fillStyle=this.alternateBackgroundColor1;break;case"alternate2":t.fillStyle=this.alternateBackgroundColor2}else o=!1;o&&(t.fillRect(-this.width/2,r,this.width,null!=i?i:0),r=null,i=null)}t.restore()}getTableBackGroundData(){const t=[];for(let e=0;e<this.rows;e++)-1!=this.highlightedRows.indexOf(e)?t.push("highlight"):null!=this.backgroundColor?t.push("color"):this.alternateBackgroundColor1&&this.alternateBackgroundColor2?e%2==0?t.push("alternate1"):t.push("alternate2"):t.push("none");return t}getHeightOfRow(t){let e,s=0;for(let r=0;r<this.columns;r++)e=this.tableArray[r][t].calcTextHeight(),e>s&&(s=e);return s}getWidthOfColumn(t){let e,s=0;for(let r=0;r<this.rows;r++)e=this.tableArray[t][r].calcTextWidth(),e>s&&(s=e);return s}drawColumnBorders(t){const e=this.getObjects();let s,r,i,o=this.rows;for(let h=2;h<=this.columns;h++){for(s=0;e[o]&&e[o].column==h;)r=e[o].width,r>s&&(s=r,i=o),o++;i&&(t.beginPath(),t.moveTo(e[i].left-this.xSpacing/2,-this.height/2),t.lineTo(e[i].left-this.xSpacing/2,-this.height/2+this.height),t.stroke())}}drawRowBorders(t){const e=this.getObjects();for(let s=1;s<this.rows;s++){const r=-this.width/2,i=e[s].top-this.ySpacing/2,o=r+this.width,h=i;t.beginPath(),t.moveTo(r,i),t.lineTo(o,h),t.stroke()}}isTableLayout(){return"layout-1"==this.layoutType||"custom-table"==this.layoutType}}t(r,"type","table"),s.setClass(r),s.setClass(r,"table");export{r as Table};
//# sourceMappingURL=Table.min.mjs.map

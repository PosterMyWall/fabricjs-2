import{defineProperty as t}from"../../_virtual/_rollupPluginBabelHelpers.min.mjs";import{Group as e}from"./Group.min.mjs";import{classRegistry as s}from"../ClassRegistry.min.mjs";class i extends e{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),t(this,"rows",0),t(this,"columns",0),t(this,"layoutType",""),t(this,"alternateBackgroundColor1",null),t(this,"alternateBackgroundColor2",null),t(this,"highlightedRowsBackgroundColor",null),t(this,"highlightedRows",[]),t(this,"tableArray",[[]]),t(this,"ySpacing",0),t(this,"xSpacing",0),t(this,"fontSize",0),t(this,"hasButton",!0)}render(t){this._transformDone=!0,super.render(t),t.save(),this.transform(t),this.renderTableBorders(t),t.restore(),this._transformDone=!1}renderTableBorders(t){this.stroke&&0!==this.strokeWidth&&(t.save(),this._setStrokeStyles(t,this),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),this.isTableLayout()&&(this.drawColumnBorders(t),this.drawRowBorders(t)),t.restore())}isTable(){return!0}_renderBackground(t){if(0==this.highlightedRows.length&&(!this.alternateBackgroundColor1||!this.alternateBackgroundColor2)||!this.isTableLayout())return void super._renderBackground(t);const e=this.getTableBackGroundData();t.save();const s=this.getObjects();let i=null,r=null,o=!1;for(let l=0;l<e.length;l++)if(o=!1,"none"!=e[l]){if(null==i&&(i=0==l?-this.height/2:s[l].top-this.ySpacing/2),e[l]!=e[l+1])switch(r=Math.abs(i-s[l].top)+this.getHeightOfRow(l)+this.ySpacing/2,o=!0,e[l]){case"highlight":t.fillStyle=this.highlightedRowsBackgroundColor;break;case"color":t.fillStyle=this.backgroundColor;break;case"alternate1":t.fillStyle=this.alternateBackgroundColor1;break;case"alternate2":t.fillStyle=this.alternateBackgroundColor2}else o=!1;var h;if(o)t.fillRect(-this.width/2,i,this.width,null!==(h=r)&&void 0!==h?h:0),i=null,r=null}t.restore()}getTableBackGroundData(){const t=[];for(let e=0;e<this.rows;e++)-1!=this.highlightedRows.indexOf(e)?t.push("highlight"):null!=this.backgroundColor?t.push("color"):this.alternateBackgroundColor1&&this.alternateBackgroundColor2?e%2==0?t.push("alternate1"):t.push("alternate2"):t.push("none");return t}getHeightOfRow(t){let e,s=0;for(let i=0;i<this.columns;i++)e=this.tableArray[i][t].calcTextHeight(),e>s&&(s=e);return s}getWidthOfColumn(t){let e,s=0;for(let i=0;i<this.rows;i++)e=this.tableArray[t][i].calcTextWidth(),e>s&&(s=e);return s}drawColumnBorders(t){const e=this.getObjects();let s,i,r,o=this.rows;for(let h=2;h<=this.columns;h++){for(s=0;e[o]&&e[o].column==h;)i=e[o].width,i>s&&(s=i,r=o),o++;r&&(t.beginPath(),t.moveTo(e[r].left-this.xSpacing/2,-this.height/2),t.lineTo(e[r].left-this.xSpacing/2,-this.height/2+this.height),t.stroke())}}drawRowBorders(t){const e=this.getObjects();for(let s=1;s<this.rows;s++){const i=-this.width/2,r=e[s].top-this.ySpacing/2,o=i+this.width,h=r;t.beginPath(),t.moveTo(i,r),t.lineTo(o,h),t.stroke()}}isTableLayout(){return"layout-1"==this.layoutType||"custom-table"==this.layoutType}}t(i,"type","table"),s.setClass(i),s.setClass(i,"table");export{i as Table};
//# sourceMappingURL=Table.min.mjs.map

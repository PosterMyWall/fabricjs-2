{"version":3,"file":"Object.mjs","sources":["../../../../src/shapes/Object/Object.ts"],"sourcesContent":["import { cache } from '../../cache';\nimport { config } from '../../config';\nimport {\n  ALIASING_LIMIT,\n  CENTER,\n  iMatrix,\n  LEFT,\n  SCALE_X,\n  SCALE_Y,\n  STROKE,\n  FILL,\n  TOP,\n  VERSION,\n} from '../../constants';\nimport type { ObjectEvents } from '../../EventTypeDefs';\nimport type { XY } from '../../Point';\nimport { Point } from '../../Point';\nimport { Shadow } from '../../Shadow';\nimport type {\n  TDegree,\n  TFiller,\n  TSize,\n  TCacheCanvasDimensions,\n  Abortable,\n  TOptions,\n  ImageFormat,\n} from '../../typedefs';\nimport { classRegistry } from '../../ClassRegistry';\nimport { runningAnimations } from '../../util/animation/AnimationRegistry';\nimport { capValue } from '../../util/misc/capValue';\nimport {\n  createCanvasElement,\n  createCanvasElementFor,\n  toDataURL,\n} from '../../util/misc/dom';\nimport { invertTransform, qrDecompose } from '../../util/misc/matrix';\nimport { enlivenObjectEnlivables } from '../../util/misc/objectEnlive';\nimport {\n  resetObjectTransform,\n  saveObjectTransform,\n} from '../../util/misc/objectTransforms';\nimport { sendObjectToPlane } from '../../util/misc/planeChange';\nimport { pick, pickBy } from '../../util/misc/pick';\nimport { toFixed } from '../../util/misc/toFixed';\nimport type { Group } from '../Group';\nimport { StaticCanvas } from '../../canvas/StaticCanvas';\nimport {\n  isFiller,\n  isSerializableFiller,\n  isTextObject,\n} from '../../util/typeAssertions';\nimport type { FabricImage } from '../Image';\nimport {\n  cacheProperties,\n  fabricObjectDefaultValues,\n  stateProperties,\n} from './defaultValues';\nimport type { Gradient } from '../../gradient/Gradient';\nimport type { Pattern } from '../../Pattern';\nimport type { Canvas } from '../../canvas/Canvas';\nimport type { SerializedObjectProps } from './types/SerializedObjectProps';\nimport type { ObjectProps } from './types/ObjectProps';\nimport { getDevicePixelRatio, getEnv } from '../../env';\nimport { log } from '../../util/internals/console';\nimport type { TColorArg } from '../../color/typedefs';\nimport type { TAnimation } from '../../util/animation/animate';\nimport { animate, animateColor } from '../../util/animation/animate';\nimport type {\n  AnimationOptions,\n  ArrayAnimationOptions,\n  ColorAnimationOptions,\n  ValueAnimationOptions,\n} from '../../util/animation/types';\nimport { ObjectGeometry } from './ObjectGeometry';\n\ntype TAncestor = FabricObject;\ntype TCollection = Group;\n\nexport type Ancestors =\n  | [FabricObject | Group]\n  | [FabricObject | Group, ...Group[]]\n  | Group[];\n\nexport type AncestryComparison = {\n  /**\n   * common ancestors of `this` and`other`(may include`this` | `other`)\n   */\n  common: Ancestors;\n  /**\n   * ancestors that are of `this` only\n   */\n  fork: Ancestors;\n  /**\n   * ancestors that are of `other` only\n   */\n  otherFork: Ancestors;\n};\nimport { degreesToRadians } from '../../util/misc/radiansDegreesConversion';\n\nexport type TCachedFabricObject<T extends FabricObject = FabricObject> = T &\n  Required<\n    Pick<\n      T,\n      | 'zoomX'\n      | 'zoomY'\n      | '_cacheCanvas'\n      | '_cacheContext'\n      | 'cacheTranslationX'\n      | 'cacheTranslationY'\n    >\n  > & {\n  _cacheContext: CanvasRenderingContext2D;\n};\n\nexport type ObjectToCanvasElementOptions = {\n  format?: ImageFormat;\n  /** Multiplier to scale by */\n  multiplier?: number;\n  /** Cropping left offset. Introduced in v1.2.14 */\n  left?: number;\n  /** Cropping top offset. Introduced in v1.2.14 */\n  top?: number;\n  /** Cropping width. Introduced in v1.2.14 */\n  width?: number;\n  /** Cropping height. Introduced in v1.2.14 */\n  height?: number;\n  /** Enable retina scaling for clone image. Introduce in 1.6.4 */\n  enableRetinaScaling?: boolean;\n  /** Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4 */\n  withoutTransform?: boolean;\n  /** Remove current object shadow. Introduced in 2.4.2 */\n  withoutShadow?: boolean;\n  /** Account for canvas viewport transform */\n  viewportTransform?: boolean;\n  expandBoundingBoxByFont?: boolean;\n  /** Function to create the output canvas to export onto */\n  canvasProvider?: <T extends StaticCanvas>(el?: HTMLCanvasElement) => T;\n};\n\ntype toDataURLOptions = ObjectToCanvasElementOptions & {\n  quality?: number;\n};\n\nexport type DrawContext =\n  | {\n      parentClipPaths: FabricObject[];\n      width: number;\n      height: number;\n      cacheTranslationX: number;\n      cacheTranslationY: number;\n      zoomX: number;\n      zoomY: number;\n    }\n  | Record<string, never>;\n\ninterface GetCornerPointsResponse {\n  tl: Point;\n  tr: Point;\n  bl: Point;\n  br: Point;\n}\n\n/**\n * Root object class from which all 2d shape classes inherit from\n * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#objects}\n *\n * @fires added\n * @fires removed\n *\n * @fires selected\n * @fires deselected\n *\n * @fires rotating\n * @fires scaling\n * @fires moving\n * @fires skewing\n * @fires modified\n *\n * @fires mousedown\n * @fires mouseup\n * @fires mouseover\n * @fires mouseout\n * @fires mousewheel\n * @fires mousedblclick\n *\n * @fires dragover\n * @fires dragenter\n * @fires dragleave\n * @fires drop\n */\nexport class FabricObject<\n  Props extends TOptions<ObjectProps> = Partial<ObjectProps>,\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  SProps extends SerializedObjectProps = SerializedObjectProps,\n  EventSpec extends ObjectEvents = ObjectEvents,\n>\n  extends ObjectGeometry<EventSpec>\n  implements ObjectProps {\n  declare minScaleLimit: number;\n\n  declare opacity: number;\n  declare __PMWTESTPROPERTY: string;\n  declare __PMWID: string;\n  declare uniformScaling: boolean\n  declare erasable: boolean | 'deep';\n  declare bindedObjectPmwId: string;\n\n  declare paintFirst: 'fill' | 'stroke';\n  declare fill: string | TFiller | null;\n  declare fillRule: CanvasFillRule;\n  declare stroke: string | TFiller | null;\n  declare strokeDashArray: number[] | null;\n  declare strokeDashOffset: number;\n  declare strokeLineCap: CanvasLineCap;\n  declare strokeLineJoin: CanvasLineJoin;\n  declare strokeMiterLimit: number;\n\n  declare globalCompositeOperation: GlobalCompositeOperation;\n  declare backgroundColor: string;\n\n  /**\n   * *PMW property added*\n   * Whether to render a rectangle background or a tilted background\n   */\n  declare leanBackground: boolean;\n\n  /**\n   * *PMW property added*\n   * Leanness of background\n   */\n  declare leanBackgroundOffset: number;\n\n  declare shadow: Shadow | null;\n\n  declare visible: boolean;\n\n  declare includeDefaultValues: boolean;\n  declare excludeFromExport: boolean;\n\n  declare objectCaching: boolean;\n\n  declare clipPath?: FabricObject;\n  declare inverted: boolean;\n  declare absolutePositioned: boolean;\n  declare centeredRotation: boolean;\n  declare centeredScaling: boolean;\n\n  /**\n   * *PMW* new property\n   * PosterMyWall property for the default text of the button.\n   * @default\n   */\n  declare pmwBmBtnText: string;\n\n  /**\n   * *PMW* new property\n   * An svg of the icon place in the pmw bottom-middle button\n   * @default\n   */\n  declare pmwBmBtnIcon: string;\n\n  /**\n   * This list of properties is used to check if the state of an object is changed.\n   * This state change now is only used for children of groups to understand if a group\n   * needs its cache regenerated during a .set call\n   * @type Array\n   */\n  static stateProperties: string[] = stateProperties;\n\n  /**\n   * List of properties to consider when checking if cache needs refresh\n   * Those properties are checked by\n   * calls to Object.set(key, value). If the key is in this list, the object is marked as dirty\n   * and refreshed at the next render\n   * @type Array\n   */\n  static cacheProperties: string[] = cacheProperties;\n\n  /**\n   * When set to `true`, object's cache will be rerendered next render call.\n   * since 1.7.0\n   * @type Boolean\n   * @default true\n   */\n  declare dirty: boolean;\n\n  /**\n   * Quick access for the _cacheCanvas rendering context\n   * This is part of the objectCaching feature\n   * since 1.7.0\n   * @type boolean\n   * @default undefined\n   * @private\n   */\n  _cacheContext: CanvasRenderingContext2D | null = null;\n\n  /**\n   * A reference to the HTMLCanvasElement that is used to contain the cache of the object\n   * this canvas element is resized and cleared as needed\n   * Is marked private, you can read it, don't use it since it is handled by fabric\n   * since 1.7.0\n   * @type HTMLCanvasElement\n   * @default undefined\n   * @private\n   */\n  declare _cacheCanvas?: HTMLCanvasElement;\n\n  /**\n   * zoom level used on the cacheCanvas to draw the cache, X axe\n   * since 1.7.0\n   * @type number\n   * @default undefined\n   * @private\n   */\n  declare zoomX?: number;\n\n  /**\n   * zoom level used on the cacheCanvas to draw the cache, Y axe\n   * since 1.7.0\n   * @type number\n   * @default undefined\n   * @private\n   */\n  declare zoomY?: number;\n\n  /**\n   * zoom level used on the cacheCanvas to draw the cache, Y axe\n   * since 1.7.0\n   * @type number\n   * @default undefined\n   * @private\n   */\n  declare cacheTranslationX?: number;\n\n  /**\n   * translation of the cacheCanvas away from the center, for subpixel accuracy and crispness\n   * since 1.7.0\n   * @type number\n   * @default undefined\n   * @private\n   */\n  declare cacheTranslationY?: number;\n\n  /**\n   * A reference to the parent of the object, usually a Group\n   * @type number\n   * @default undefined\n   * @private\n   */\n  declare group?: Group;\n\n  /**\n   * Indicate if the object is sitting on a cache dedicated to it\n   * or is part of a larger cache for many object ( a group for example)\n   * @type number\n   * @default undefined\n   * @private\n   */\n  declare ownCaching?: boolean;\n\n  /**\n   * Private. indicates if the object inside a group is on a transformed context or not\n   * or is part of a larger cache for many object ( a group for example)\n   * @type boolean\n   * @default undefined\n   * @private\n   */\n  declare _transformDone?: boolean;\n\n  static ownDefaults = fabricObjectDefaultValues;\n\n  static getDefaults(): Record<string, any> {\n    return FabricObject.ownDefaults;\n  }\n\n  /**\n   * The class type.\n   * This is used for serialization and deserialization purposes and internally it can be used\n   * to identify classes.\n   * When we transform a class in a plain JS object we need a way to recognize which class it was,\n   * and the type is the way we do that. It has no other purposes and you should not give one.\n   * Hard to reach on instances and please do not use to drive instance's logic (this.constructor.type).\n   * To idenfity a class use instanceof class ( instanceof Rect ).\n   * We do not do that in fabricJS code because we want to try to have code splitting possible.\n   */\n  static type = 'FabricObject';\n\n  /**\n   * Legacy identifier of the class. Prefer using utils like isType or instanceOf\n   * Will be removed in fabric 7 or 8.\n   * The setter exists to avoid type errors in old code and possibly current deserialization code.\n   * DO NOT build new code around this type value\n   * @TODO add sustainable warning message\n   * @type string\n   * @deprecated\n   */\n  get type() {\n    const name = (this.constructor as typeof FabricObject).type;\n    if (name === 'FabricObject') {\n      return 'object';\n    }\n    return name.toLowerCase();\n  }\n\n  set type(value) {\n    log('warn', 'Setting type has no effect', value);\n  }\n\n  /**\n   * Constructor\n   * @param {Object} [options] Options object\n   */\n  constructor(options?: Props) {\n    super();\n    Object.assign(this, FabricObject.ownDefaults);\n    this.setOptions(options);\n  }\n\n  /**\n   * Create a the canvas used to keep the cached copy of the object\n   * @private\n   */\n  _createCacheCanvas() {\n    this._cacheCanvas = createCanvasElement();\n    this._cacheContext = this._cacheCanvas.getContext('2d');\n    this._updateCacheCanvas();\n    // if canvas gets created, is empty, so dirty.\n    this.dirty = true;\n  }\n\n  /**\n   * Limit the cache dimensions so that X * Y do not cross config.perfLimitSizeTotal\n   * and each side do not cross fabric.cacheSideLimit\n   * those numbers are configurable so that you can get as much detail as you want\n   * making bargain with performances.\n   * @param {Object} dims\n   * @param {Object} dims.width width of canvas\n   * @param {Object} dims.height height of canvas\n   * @param {Object} dims.zoomX zoomX zoom value to unscale the canvas before drawing cache\n   * @param {Object} dims.zoomY zoomY zoom value to unscale the canvas before drawing cache\n   * @return {Object}.width width of canvas\n   * @return {Object}.height height of canvas\n   * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n   * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n   */\n  _limitCacheSize(\n    dims: TSize & { zoomX: number; zoomY: number; capped: boolean } & any,\n  ) {\n    const width = dims.width,\n      height = dims.height,\n      max = config.maxCacheSideLimit,\n      min = config.minCacheSideLimit;\n    if (\n      width <= max &&\n      height <= max &&\n      width * height <= config.perfLimitSizeTotal\n    ) {\n      if (width < min) {\n        dims.width = min;\n      }\n      if (height < min) {\n        dims.height = min;\n      }\n      return dims;\n    }\n    const ar = width / height,\n      [limX, limY] = cache.limitDimsByArea(ar),\n      x = capValue(min, limX, max),\n      y = capValue(min, limY, max);\n    if (width > x) {\n      dims.zoomX /= width / x;\n      dims.width = x;\n      dims.capped = true;\n    }\n    if (height > y) {\n      dims.zoomY /= height / y;\n      dims.height = y;\n      dims.capped = true;\n    }\n    return dims;\n  }\n\n  /**\n   * Return the dimension and the zoom level needed to create a cache canvas\n   * big enough to host the object to be cached.\n   * @private\n   * @return {Object}.x width of object to be cached\n   * @return {Object}.y height of object to be cached\n   * @return {Object}.width width of canvas\n   * @return {Object}.height height of canvas\n   * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n   * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n   */\n  _getCacheCanvasDimensions(): TCacheCanvasDimensions {\n    const objectScale = this.getTotalObjectScaling(),\n      // calculate dimensions without skewing\n      dim = this._getTransformedDimensions({ skewX: 0, skewY: 0 }),\n      neededX = (dim.x * objectScale.x) / this.scaleX,\n      neededY = (dim.y * objectScale.y) / this.scaleY;\n    return {\n      // for sure this ALIASING_LIMIT is slightly creating problem\n      // in situation in which the cache canvas gets an upper limit\n      // also objectScale contains already scaleX and scaleY\n      width: neededX + ALIASING_LIMIT,\n      height: neededY + ALIASING_LIMIT,\n      zoomX: objectScale.x,\n      zoomY: objectScale.y,\n      x: neededX,\n      y: neededY,\n    };\n  }\n\n  /**\n   * Update width and height of the canvas for cache\n   * returns true or false if canvas needed resize.\n   * @private\n   * @return {Boolean} true if the canvas has been resized\n   */\n  _updateCacheCanvas() {\n    const canvas = this._cacheCanvas!,\n      context = this._cacheContext,\n      dims = this._limitCacheSize(this._getCacheCanvasDimensions()),\n      minCacheSize = config.minCacheSideLimit,\n      width = dims.width,\n      height = dims.height,\n      zoomX = dims.zoomX,\n      zoomY = dims.zoomY,\n      dimensionsChanged = width !== canvas.width || height !== canvas.height,\n      zoomChanged = this.zoomX !== zoomX || this.zoomY !== zoomY;\n\n    if (!canvas || !context) {\n      return false;\n    }\n\n    let drawingWidth,\n      drawingHeight,\n      shouldRedraw = dimensionsChanged || zoomChanged,\n      additionalWidth = 0,\n      additionalHeight = 0,\n      shouldResizeCanvas = false;\n\n    if (dimensionsChanged) {\n      const canvasWidth = (this._cacheCanvas as HTMLCanvasElement).width,\n        canvasHeight = (this._cacheCanvas as HTMLCanvasElement).height,\n        sizeGrowing = width > canvasWidth || height > canvasHeight,\n        sizeShrinking =\n          (width < canvasWidth * 0.9 || height < canvasHeight * 0.9) &&\n          canvasWidth > minCacheSize &&\n          canvasHeight > minCacheSize;\n      shouldResizeCanvas = sizeGrowing || sizeShrinking;\n      if (\n        sizeGrowing &&\n        !dims.capped &&\n        (width > minCacheSize || height > minCacheSize)\n      ) {\n        additionalWidth = width * 0.1;\n        additionalHeight = height * 0.1;\n      }\n    }\n    if (isTextObject(this) && this.path) {\n      shouldRedraw = true;\n      shouldResizeCanvas = true;\n      // IMHO in those lines we are using zoomX and zoomY not the this version.\n      additionalWidth += this.getHeightOfLine(0) * this.zoomX!;\n      additionalHeight += this.getHeightOfLine(0) * this.zoomY!;\n    }\n    if (shouldRedraw) {\n      if (shouldResizeCanvas) {\n        canvas.width = Math.ceil(width + additionalWidth);\n        canvas.height = Math.ceil(height + additionalHeight);\n      } else {\n        context.setTransform(1, 0, 0, 1, 0, 0);\n        context.clearRect(0, 0, canvas.width, canvas.height);\n      }\n      drawingWidth = dims.x / 2;\n      drawingHeight = dims.y / 2;\n      this.cacheTranslationX =\n        Math.round(canvas.width / 2 - drawingWidth) + drawingWidth;\n      this.cacheTranslationY =\n        Math.round(canvas.height / 2 - drawingHeight) + drawingHeight;\n      context.translate(this.cacheTranslationX, this.cacheTranslationY);\n      context.scale(zoomX, zoomY);\n      this.zoomX = zoomX;\n      this.zoomY = zoomY;\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Sets object's properties from options, for class constructor only.\n   * Needs to be overridden for different defaults.\n   * @protected\n   * @param {Object} [options] Options object\n   */\n  protected setOptions(options: Record<string, any> = {}) {\n    this._setOptions(options);\n  }\n\n  /**\n   * Transforms context when rendering an object\n   * @param {CanvasRenderingContext2D} ctx Context\n   */\n  transform(ctx: CanvasRenderingContext2D) {\n    const needFullTransform =\n      (this.group && !this.group._transformDone) ||\n      (this.group && this.canvas && ctx === (this.canvas as Canvas).contextTop);\n    const m = this.calcTransformMatrix(!needFullTransform);\n    ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n  }\n\n  /**\n   * Return the object scale factor counting also the group scaling\n   * @return {Point}\n   */\n  getObjectScaling() {\n    // if the object is a top level one, on the canvas, we go for simple aritmetic\n    // otherwise the complex method with angles will return approximations and decimals\n    // and will likely kill the cache when not needed\n    // https://github.com/fabricjs/fabric.js/issues/7157\n    if (!this.group) {\n      return new Point(Math.abs(this.scaleX), Math.abs(this.scaleY));\n    }\n    // if we are inside a group total zoom calculation is complex, we defer to generic matrices\n    const options = qrDecompose(this.calcTransformMatrix());\n    return new Point(Math.abs(options.scaleX), Math.abs(options.scaleY));\n  }\n\n  /**\n   * Return the object scale factor counting also the group scaling, zoom and retina\n   * @return {Object} object with scaleX and scaleY properties\n   */\n  getTotalObjectScaling() {\n    const scale = this.getObjectScaling();\n    if (this.canvas) {\n      const zoom = this.canvas.getZoom();\n      const retina = this.getCanvasRetinaScaling();\n      return scale.scalarMultiply(zoom * retina);\n    }\n    return scale;\n  }\n\n  /**\n   * Return the object opacity counting also the group property\n   * @return {Number}\n   */\n  getObjectOpacity() {\n    let opacity = this.opacity;\n    if (this.group) {\n      opacity *= this.group.getObjectOpacity();\n    }\n    return opacity;\n  }\n\n  /**\n   * Makes sure the scale is valid and modifies it if necessary\n   * @todo: this is a control action issue, not a geometry one\n   * @private\n   * @param {Number} value, unconstrained\n   * @return {Number} constrained value;\n   */\n  _constrainScale(value: number): number {\n    if (Math.abs(value) < this.minScaleLimit) {\n      if (value < 0) {\n        return -this.minScaleLimit;\n      } else {\n        return this.minScaleLimit;\n      }\n    } else if (value === 0) {\n      return 0.0001;\n    }\n    return value;\n  }\n\n  /**\n   * Handles setting values on the instance and handling internal side effects\n   * @protected\n   * @param {String} key\n   * @param {*} value\n   */\n  _set(key: string, value: any) {\n    if (key === SCALE_X || key === SCALE_Y) {\n      value = this._constrainScale(value);\n    }\n    if (key === SCALE_X && value < 0) {\n      this.flipX = !this.flipX;\n      value *= -1;\n    } else if (key === 'scaleY' && value < 0) {\n      this.flipY = !this.flipY;\n      value *= -1;\n      // i don't like this automatic initialization here\n    } else if (key === 'shadow' && value && !(value instanceof Shadow)) {\n      value = new Shadow(value);\n    }\n\n    const isChanged = this[key as keyof this] !== value;\n    this[key as keyof this] = value;\n\n    // invalidate caches\n    if (\n      isChanged &&\n      (this.constructor as typeof FabricObject).cacheProperties.includes(key)\n    ) {\n      this.dirty = true;\n    }\n    // a dirty child makes the parent dirty.\n    // but a non dirty child does not make the parent not dirty.\n    // the parent could be dirty for some other reason.\n    this.parent &&\n    (this.dirty ||\n      (isChanged &&\n        (this.constructor as typeof FabricObject).stateProperties.includes(\n          key,\n        ))) &&\n    this.parent._set('dirty', true);\n\n    return this;\n  }\n\n  /*\n   * @private\n   * return if the object would be visible in rendering\n   * @memberOf FabricObject.prototype\n   * @return {Boolean}\n   */\n  isNotVisible() {\n    return (\n      this.opacity === 0 ||\n      (!this.width && !this.height && this.strokeWidth === 0) ||\n      !this.visible\n    );\n  }\n\n  /**\n   * Renders an object on a specified context\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  render(ctx: CanvasRenderingContext2D) {\n    // do not render if width/height are zeros or object is not visible\n    if (this.isNotVisible()) {\n      return;\n    }\n    if (\n      this.canvas &&\n      this.canvas.skipOffscreen &&\n      !this.group &&\n      !this.isOnScreen()\n    ) {\n      return;\n    }\n    ctx.save();\n    this._setupCompositeOperation(ctx);\n    this.drawSelectionBackground(ctx);\n    this.transform(ctx);\n    this._setOpacity(ctx);\n    this._setShadow(ctx);\n    if (this.shouldCache()) {\n      (this as TCachedFabricObject).renderCache();\n      (this as TCachedFabricObject).drawCacheOnCanvas(ctx);\n    } else {\n      this._removeCacheCanvas();\n      this.drawObject(ctx, false, {});\n      this.dirty = false;\n    }\n    ctx.restore();\n  }\n\n  drawSelectionBackground(_ctx: CanvasRenderingContext2D) {\n    /* no op */\n  }\n\n  renderCache(this: TCachedFabricObject, options?: any) {\n    options = options || {};\n    if (!this._cacheCanvas || !this._cacheContext) {\n      this._createCacheCanvas();\n    }\n    if (this.isCacheDirty() && this._cacheContext) {\n      const { zoomX, zoomY, cacheTranslationX, cacheTranslationY } = this;\n      const { width, height } = this._cacheCanvas;\n      this.drawObject(this._cacheContext, options.forClipping, {\n        zoomX,\n        zoomY,\n        cacheTranslationX,\n        cacheTranslationY,\n        width,\n        height,\n        parentClipPaths: [],\n      });\n      this.dirty = false;\n    }\n  }\n\n  /**\n   * Remove cacheCanvas and its dimensions from the objects\n   */\n  _removeCacheCanvas() {\n    this._cacheCanvas = undefined;\n    this._cacheContext = null;\n  }\n\n  /**\n   * return true if the object will draw a stroke\n   * Does not consider text styles. This is just a shortcut used at rendering time\n   * We want it to be an approximation and be fast.\n   * wrote to avoid extra caching, it has to return true when stroke happens,\n   * can guess when it will not happen at 100% chance, does not matter if it misses\n   * some use case where the stroke is invisible.\n   * @since 3.0.0\n   * @returns Boolean\n   */\n  hasStroke() {\n    return (\n      this.stroke && this.stroke !== 'transparent' && this.strokeWidth !== 0\n    );\n  }\n\n  /**\n   * return true if the object will draw a fill\n   * Does not consider text styles. This is just a shortcut used at rendering time\n   * We want it to be an approximation and be fast.\n   * wrote to avoid extra caching, it has to return true when fill happens,\n   * can guess when it will not happen at 100% chance, does not matter if it misses\n   * some use case where the fill is invisible.\n   * @since 3.0.0\n   * @returns Boolean\n   */\n  hasFill() {\n    return this.fill && this.fill !== 'transparent';\n  }\n\n  /**\n   * When set to `true`, force the object to have its own cache, even if it is inside a group\n   * it may be needed when your object behave in a particular way on the cache and always needs\n   * its own isolated canvas to render correctly.\n   * Created to be overridden\n   * since 1.7.12\n   * @returns Boolean\n   */\n  needsItsOwnCache() {\n    if (\n      this.paintFirst === STROKE &&\n      this.hasFill() &&\n      this.hasStroke() &&\n      !!this.shadow\n    ) {\n      return true;\n    }\n    if (this.clipPath) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Decide if the object should cache or not. Create its own cache level\n   * objectCaching is a global flag, wins over everything\n   * needsItsOwnCache should be used when the object drawing method requires\n   * a cache step. None of the fabric classes requires it.\n   * Generally you do not cache objects in groups because the group outside is cached.\n   * Read as: cache if is needed, or if the feature is enabled but we are not already caching.\n   * @return {Boolean}\n   */\n  shouldCache() {\n    this.ownCaching =\n      this.needsItsOwnCache() ||\n      (this.objectCaching && (!this.parent || !this.parent.isOnACache()));\n    return this.ownCaching;\n  }\n\n  /**\n   * Check if this object will cast a shadow with an offset.\n   * used by Group.shouldCache to know if child has a shadow recursively\n   * @return {Boolean}\n   * @deprecated\n   */\n  willDrawShadow() {\n    return (\n      !!this.shadow && (this.shadow.offsetX !== 0 || this.shadow.offsetY !== 0)\n    );\n  }\n\n  /**\n   * Execute the drawing operation for an object clipPath\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   * @param {FabricObject} clipPath\n   */\n  drawClipPathOnCache(\n    ctx: CanvasRenderingContext2D,\n    clipPath: FabricObject,\n    canvasWithClipPath: HTMLCanvasElement,\n  ) {\n    ctx.save();\n    // DEBUG: uncomment this line, comment the following\n    // ctx.globalAlpha = 0.4\n    if (clipPath.inverted) {\n      ctx.globalCompositeOperation = 'destination-out';\n    } else {\n      ctx.globalCompositeOperation = 'destination-in';\n    }\n    ctx.setTransform(1, 0, 0, 1, 0, 0);\n    //ctx.scale(1 / 2, 1 / 2);\n    ctx.drawImage(canvasWithClipPath, 0, 0);\n    ctx.restore();\n  }\n\n  /**\n   * Execute the drawing operation for an object on a specified context\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   * @param {boolean} forClipping apply clipping styles\n   * @param {DrawContext} context additional context for rendering\n   */\n  drawObject(\n    ctx: CanvasRenderingContext2D,\n    forClipping: boolean | undefined,\n    context: DrawContext,\n  ) {\n    const originalFill = this.fill,\n      originalStroke = this.stroke;\n    if (forClipping) {\n      this.fill = 'black';\n      this.stroke = '';\n      this._setClippingProperties(ctx);\n    } else {\n      this._renderBackground(ctx);\n    }\n    this._render(ctx);\n    this._drawClipPath(ctx, this.clipPath, context);\n    this.fill = originalFill;\n    this.stroke = originalStroke;\n  }\n\n  private createClipPathLayer(\n    this: TCachedFabricObject,\n    clipPath: FabricObject,\n    context: DrawContext,\n  ) {\n    const canvas = createCanvasElementFor(context as TSize);\n    const ctx = canvas.getContext('2d')!;\n    ctx.translate(context.cacheTranslationX, context.cacheTranslationY);\n    ctx.scale(context.zoomX, context.zoomY);\n    clipPath._cacheCanvas = canvas;\n    context.parentClipPaths.forEach((prevClipPath) => {\n      prevClipPath.transform(ctx);\n    });\n    context.parentClipPaths.push(clipPath);\n    if (clipPath.absolutePositioned) {\n      const m = invertTransform(this.calcTransformMatrix());\n      ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n    }\n    clipPath.transform(ctx);\n    clipPath.drawObject(ctx, true, context);\n    return canvas;\n  }\n\n  /**\n   * Prepare clipPath state and cache and draw it on instance's cache\n   * @param {CanvasRenderingContext2D} ctx\n   * @param {FabricObject} clipPath\n   */\n  _drawClipPath(\n    ctx: CanvasRenderingContext2D,\n    clipPath: FabricObject | undefined,\n    context: DrawContext,\n  ) {\n    if (!clipPath) {\n      return;\n    }\n    // needed to setup _transformDone\n    // TODO find a better solution?\n    clipPath._transformDone = true;\n    const canvas = (this as TCachedFabricObject).createClipPathLayer(\n      clipPath,\n      context,\n    );\n    this.drawClipPathOnCache(ctx, clipPath, canvas);\n  }\n\n  /**\n   * Paint the cached copy of the object on the target context.\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  drawCacheOnCanvas(this: TCachedFabricObject, ctx: CanvasRenderingContext2D) {\n    ctx.scale(1 / this.zoomX, 1 / this.zoomY);\n    ctx.drawImage(\n      this._cacheCanvas,\n      -this.cacheTranslationX,\n      -this.cacheTranslationY,\n    );\n  }\n\n  /**\n   * Check if cache is dirty\n   * @param {Boolean} skipCanvas skip canvas checks because this object is painted\n   * on parent canvas.\n   */\n  isCacheDirty(skipCanvas = false) {\n    if (this.isNotVisible()) {\n      return false;\n    }\n    const canvas = this._cacheCanvas;\n    const ctx = this._cacheContext;\n    if (canvas && ctx && !skipCanvas && this._updateCacheCanvas()) {\n      // in this case the context is already cleared.\n      return true;\n    } else {\n      if (this.dirty || (this.clipPath && this.clipPath.absolutePositioned)) {\n        if (canvas && ctx && !skipCanvas) {\n          ctx.save();\n          ctx.setTransform(1, 0, 0, 1, 0, 0);\n          ctx.clearRect(0, 0, canvas.width, canvas.height);\n          ctx.restore();\n        }\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Draws a background for the object big as its untransformed dimensions\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  _renderBackground(ctx: CanvasRenderingContext2D) {\n    if (!this.backgroundColor) {\n      return;\n    }\n    if (this.leanBackground) {\n      ctx.save();\n      ctx.fillStyle = this.backgroundColor;\n      ctx.beginPath();\n      const offset = this.leanBackgroundOffset / 4,\n        slant = this.leanBackgroundOffset / 2,\n        yFix = this.leanBackgroundOffset / 10;\n      ctx.moveTo(-this.width / 2 + offset, -this.height / 2 - yFix);\n      ctx.lineTo(\n        -this.width / 2 + this.width + offset,\n        -this.height / 2 - yFix,\n      );\n      ctx.lineTo(\n        -this.width / 2 + this.width - slant + offset,\n        -this.height / 2 + this.height - yFix,\n      );\n      ctx.lineTo(\n        -this.width / 2 - slant + offset,\n        -this.height / 2 + this.height - yFix,\n      );\n      ctx.closePath();\n      ctx.fill();\n      ctx.restore();\n    } else {\n      const dim = this._getNonTransformedDimensions();\n      ctx.fillStyle = this.backgroundColor;\n\n      ctx.fillRect(-dim.x / 2, -dim.y / 2, dim.x, dim.y);\n    }\n    // if there is background color no other shadows\n    // should be casted\n    this._removeShadow(ctx);\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  _setOpacity(ctx: CanvasRenderingContext2D) {\n    if (this.group && !this.group._transformDone) {\n      ctx.globalAlpha = this.getObjectOpacity();\n    } else {\n      ctx.globalAlpha *= this.opacity;\n    }\n  }\n\n  _setStrokeStyles(\n    ctx: CanvasRenderingContext2D,\n    decl: Pick<\n      this,\n      | 'stroke'\n      | 'strokeWidth'\n      | 'strokeLineCap'\n      | 'strokeDashOffset'\n      | 'strokeLineJoin'\n      | 'strokeMiterLimit'\n    >,\n  ) {\n    const stroke = decl.stroke;\n    if (stroke) {\n      ctx.lineWidth = decl.strokeWidth;\n      ctx.lineCap = decl.strokeLineCap;\n      ctx.lineDashOffset = decl.strokeDashOffset;\n      ctx.lineJoin = decl.strokeLineJoin;\n      ctx.miterLimit = decl.strokeMiterLimit;\n      if (isFiller(stroke)) {\n        if (\n          (stroke as Gradient<'linear'>).gradientUnits === 'percentage' ||\n          (stroke as Gradient<'linear'>).gradientTransform ||\n          (stroke as Pattern).patternTransform\n        ) {\n          // need to transform gradient in a pattern.\n          // this is a slow process. If you are hitting this codepath, and the object\n          // is not using caching, you should consider switching it on.\n          // we need a canvas as big as the current object caching canvas.\n          this._applyPatternForTransformedGradient(ctx, stroke);\n        } else {\n          // is a simple gradient or pattern\n          ctx.strokeStyle = stroke.toLive(ctx)!;\n          this._applyPatternGradientTransform(ctx, stroke);\n        }\n      } else {\n        // is a color\n        ctx.strokeStyle = decl.stroke as string;\n      }\n    }\n  }\n\n  _setFillStyles(ctx: CanvasRenderingContext2D, { fill }: Pick<this, 'fill'>) {\n    if (fill) {\n      if (isFiller(fill)) {\n        ctx.fillStyle = fill.toLive(ctx)!;\n        this._applyPatternGradientTransform(ctx, fill);\n      } else {\n        ctx.fillStyle = fill;\n      }\n    }\n  }\n\n  _setClippingProperties(ctx: CanvasRenderingContext2D) {\n    ctx.globalAlpha = 1;\n    ctx.strokeStyle = 'transparent';\n    ctx.fillStyle = '#000000';\n  }\n\n  /**\n   * @private\n   * Sets line dash\n   * @param {CanvasRenderingContext2D} ctx Context to set the dash line on\n   * @param {Array} dashArray array representing dashes\n   */\n  _setLineDash(ctx: CanvasRenderingContext2D, dashArray?: number[] | null) {\n    if (!dashArray || dashArray.length === 0) {\n      return;\n    }\n    // Spec requires the concatenation of two copies of the dash array when the number of elements is odd\n    if (1 & dashArray.length) {\n      dashArray.push(...dashArray);\n    }\n    ctx.setLineDash(dashArray);\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  _setShadow(ctx: CanvasRenderingContext2D) {\n    if (!this.shadow) {\n      return;\n    }\n\n    const shadow = this.shadow,\n      canvas = this.canvas,\n      retinaScaling = this.getCanvasRetinaScaling(),\n      [sx, , , sy] = canvas?.viewportTransform || iMatrix,\n      multX = sx * retinaScaling,\n      multY = sy * retinaScaling,\n      scaling = shadow.nonScaling ? new Point(1, 1) : this.getObjectScaling();\n    ctx.shadowColor = shadow.color;\n    ctx.shadowBlur =\n      (shadow.blur *\n        config.browserShadowBlurConstant *\n        (multX + multY) *\n        (scaling.x + scaling.y)) /\n      4;\n    ctx.shadowOffsetX = shadow.offsetX * multX * scaling.x;\n    ctx.shadowOffsetY = shadow.offsetY * multY * scaling.y;\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  _removeShadow(ctx: CanvasRenderingContext2D) {\n    if (!this.shadow) {\n      return;\n    }\n\n    ctx.shadowColor = '';\n    ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   * @param {TFiller} filler {@link Pattern} or {@link Gradient}\n   */\n  _applyPatternGradientTransform(\n    ctx: CanvasRenderingContext2D,\n    filler: TFiller,\n  ) {\n    if (!isFiller(filler)) {\n      return { offsetX: 0, offsetY: 0 };\n    }\n    const t =\n      (filler as Gradient<'linear'>).gradientTransform ||\n      (filler as Pattern).patternTransform;\n    const offsetX = -this.width / 2 + filler.offsetX || 0,\n      offsetY = -this.height / 2 + filler.offsetY || 0;\n\n    if ((filler as Gradient<'linear'>).gradientUnits === 'percentage') {\n      ctx.transform(this.width, 0, 0, this.height, offsetX, offsetY);\n    } else {\n      ctx.transform(1, 0, 0, 1, offsetX, offsetY);\n    }\n    if (t) {\n      ctx.transform(t[0], t[1], t[2], t[3], t[4], t[5]);\n    }\n    return { offsetX: offsetX, offsetY: offsetY };\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  _renderPaintInOrder(ctx: CanvasRenderingContext2D) {\n    if (this.paintFirst === STROKE) {\n      this._renderStroke(ctx);\n      this._renderFill(ctx);\n    } else {\n      this._renderFill(ctx);\n      this._renderStroke(ctx);\n    }\n  }\n\n  /**\n   * @private\n   * function that actually render something on the context.\n   * empty here to allow Obects to work on tests to benchmark fabric functionalites\n   * not related to rendering\n   * @param {CanvasRenderingContext2D} _ctx Context to render on\n   */\n  _render(_ctx: CanvasRenderingContext2D) {\n    // placeholder to be overridden\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  _renderFill(ctx: CanvasRenderingContext2D) {\n    if (!this.fill) {\n      return;\n    }\n\n    ctx.save();\n    this._setFillStyles(ctx, this);\n    if (this.fillRule === 'evenodd') {\n      ctx.fill('evenodd');\n    } else {\n      ctx.fill();\n    }\n    ctx.restore();\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   */\n  _renderStroke(ctx: CanvasRenderingContext2D) {\n    if (!this.stroke || this.strokeWidth === 0) {\n      return;\n    }\n\n    if (this.shadow && !this.shadow.affectStroke) {\n      this._removeShadow(ctx);\n    }\n\n    ctx.save();\n    if (this.strokeUniform) {\n      const scaling = this.getObjectScaling();\n      ctx.scale(1 / scaling.x, 1 / scaling.y);\n    }\n    this._setLineDash(ctx, this.strokeDashArray);\n    this._setStrokeStyles(ctx, this);\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  /**\n   * This function try to patch the missing gradientTransform on canvas gradients.\n   * transforming a context to transform the gradient, is going to transform the stroke too.\n   * we want to transform the gradient but not the stroke operation, so we create\n   * a transformed gradient on a pattern and then we use the pattern instead of the gradient.\n   * this method has drawbacks: is slow, is in low resolution, needs a patch for when the size\n   * is limited.\n   * @private\n   * @param {CanvasRenderingContext2D} ctx Context to render on\n   * @param {Gradient} filler\n   */\n  _applyPatternForTransformedGradient(\n    ctx: CanvasRenderingContext2D,\n    filler: TFiller,\n  ) {\n    const dims = this._limitCacheSize(this._getCacheCanvasDimensions()),\n      retinaScaling = this.getCanvasRetinaScaling(),\n      width = dims.x / this.scaleX / retinaScaling,\n      height = dims.y / this.scaleY / retinaScaling,\n      pCanvas = createCanvasElementFor({\n        // in case width and height are less than 1px, we have to round up.\n        // since the pattern is no-repeat, this is fine\n        width: Math.ceil(width),\n        height: Math.ceil(height),\n      });\n\n    const pCtx = pCanvas.getContext('2d');\n    if (!pCtx) {\n      return;\n    }\n    pCtx.beginPath();\n    pCtx.moveTo(0, 0);\n    pCtx.lineTo(width, 0);\n    pCtx.lineTo(width, height);\n    pCtx.lineTo(0, height);\n    pCtx.closePath();\n    pCtx.translate(width / 2, height / 2);\n    pCtx.scale(\n      dims.zoomX / this.scaleX / retinaScaling,\n      dims.zoomY / this.scaleY / retinaScaling,\n    );\n    this._applyPatternGradientTransform(pCtx, filler);\n    pCtx.fillStyle = filler.toLive(ctx)!;\n    pCtx.fill();\n    ctx.translate(\n      -this.width / 2 - this.strokeWidth / 2,\n      -this.height / 2 - this.strokeWidth / 2,\n    );\n    ctx.scale(\n      (retinaScaling * this.scaleX) / dims.zoomX,\n      (retinaScaling * this.scaleY) / dims.zoomY,\n    );\n    ctx.strokeStyle = pCtx.createPattern(pCanvas, 'no-repeat') ?? '';\n  }\n\n  /**\n   * This function is an helper for svg import. it returns the center of the object in the svg\n   * untransformed coordinates\n   * @private\n   * @return {Point} center point from element coordinates\n   */\n  _findCenterFromElement() {\n    return new Point(this.left + this.width / 2, this.top + this.height / 2);\n  }\n\n  /**\n   * Clones an instance.\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n   * @returns {Promise<FabricObject>}\n   */\n  clone(propertiesToInclude?: string[]): Promise<this> {\n    const objectForm = this.toObject(propertiesToInclude);\n    return (this.constructor as typeof FabricObject).fromObject(\n      objectForm,\n    ) as unknown as Promise<this>;\n  }\n\n  /**\n   * Creates an instance of Image out of an object\n   * makes use of toCanvasElement.\n   * Once this method was based on toDataUrl and loadImage, so it also had a quality\n   * and format option. toCanvasElement is faster and produce no loss of quality.\n   * If you need to get a real Jpeg or Png from an object, using toDataURL is the right way to do it.\n   * toCanvasElement and then toBlob from the obtained canvas is also a good option.\n   * @todo fix the export type, it could not be Image but the type that getClass return for 'image'.\n   * @param {ObjectToCanvasElementOptions} [options] for clone as image, passed to toDataURL\n   * @param {Number} [options.multiplier=1] Multiplier to scale by\n   * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n   * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n   * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n   * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n   * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n   * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n   * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n   * @return {FabricImage} Object cloned as image.\n   */\n  cloneAsImage(options: ObjectToCanvasElementOptions): FabricImage {\n    const canvasEl = this.toCanvasElement(options);\n    // TODO: how to import Image w/o an import cycle?\n    const ImageClass = classRegistry.getClass<typeof FabricImage>('image');\n    return new ImageClass(canvasEl);\n  }\n\n  /**\n   * Converts an object into a HTMLCanvas element\n   * @param {ObjectToCanvasElementOptions} options Options object\n   * @param {Number} [options.multiplier=1] Multiplier to scale by\n   * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n   * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n   * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n   * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n   * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n   * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n   * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n   * @param {Boolean} [options.viewportTransform] Account for canvas viewport transform\n   * @param {(el?: HTMLCanvasElement) => StaticCanvas} [options.canvasProvider] Create the output canvas\n   * @return {HTMLCanvasElement} Returns DOM element <canvas> with the FabricObject\n   */\n  toCanvasElement(options: ObjectToCanvasElementOptions = {}) {\n    const origParams = saveObjectTransform(this),\n      originalGroup = this.group,\n      originalShadow = this.shadow,\n      abs = Math.abs,\n      retinaScaling = options.enableRetinaScaling ? getDevicePixelRatio() : 1,\n      multiplier = (options.multiplier || 1) * retinaScaling,\n      canvasProvider: (el: HTMLCanvasElement) => StaticCanvas =\n        options.canvasProvider ||\n        ((el: HTMLCanvasElement) =>\n          new StaticCanvas(el, {\n            enableRetinaScaling: false,\n            renderOnAddRemove: false,\n            skipOffscreen: false,\n          }));\n    delete this.group;\n    if (options.withoutTransform) {\n      resetObjectTransform(this);\n    }\n    if (options.withoutShadow) {\n      this.shadow = null;\n    }\n    if (options.viewportTransform) {\n      sendObjectToPlane(this, this.getViewportTransform());\n    }\n\n    this.setCoords();\n    const el = createCanvasElement(),\n      boundingRect = this.getBoundingRect(),\n      shadow = this.shadow,\n      shadowOffset = new Point();\n\n    /*________________________ *PMW* added portion start ________________________*/\n    // extends bounding box to cater to font of text objects inside group item (text/slideshow item).\n    // This is used to prevent text from getting cut off during pdf generation.\n\n    if (options.expandBoundingBoxByFont && this.isGroup()) {\n      let maxWidthToAdd = 0,\n        maxHeightToAdd = 0;\n      const maxFontSize = this._getMaxExpandedFontSizeFromTextChildren();\n\n      if (maxFontSize > 0) {\n        maxWidthToAdd = boundingRect.width * 0.75;\n        maxHeightToAdd = boundingRect.height * 0.75;\n      }\n\n      boundingRect.width += maxWidthToAdd;\n      boundingRect.height += maxHeightToAdd;\n    }\n    /*________________________ *PMW* added portion end ________________________*/\n\n    if (shadow) {\n      const shadowBlur = shadow.blur;\n      const scaling = shadow.nonScaling\n        ? new Point(1, 1)\n        : this.getObjectScaling();\n      // consider non scaling shadow.\n      shadowOffset.x =\n        2 * Math.round(abs(shadow.offsetX) + shadowBlur) * abs(scaling.x);\n      shadowOffset.y =\n        2 * Math.round(abs(shadow.offsetY) + shadowBlur) * abs(scaling.y);\n    }\n    const width = boundingRect.width + shadowOffset.x,\n      height = boundingRect.height + shadowOffset.y;\n    // if the current width/height is not an integer\n    // we need to make it so.\n    el.width = Math.ceil(width);\n    el.height = Math.ceil(height);\n    const canvas = canvasProvider(el);\n    if (options.format === 'jpeg') {\n      canvas.backgroundColor = '#fff';\n    }\n    this.setPositionByOrigin(\n      new Point(canvas.width / 2, canvas.height / 2),\n      CENTER,\n      CENTER,\n    );\n    const originalCanvas = this.canvas;\n    // static canvas and canvas have both an array of InteractiveObjects\n    // @ts-expect-error this needs to be fixed somehow, or ignored globally\n    canvas._objects = [this];\n    this.set('canvas', canvas);\n    this.setCoords();\n    const canvasEl = canvas.toCanvasElement(multiplier || 1, options);\n    this.set('canvas', originalCanvas);\n    this.shadow = originalShadow;\n    if (originalGroup) {\n      this.group = originalGroup;\n    }\n    this.set(origParams);\n    this.setCoords();\n    // canvas.dispose will call image.dispose that will nullify the elements\n    // since this canvas is a simple element for the process, we remove references\n    // to objects in this way in order to avoid object trashing.\n    canvas._objects = [];\n    // since render has settled it is safe to destroy canvas\n    canvas.destroy();\n    return canvasEl;\n  }\n\n  isGroup(): this is Group {\n    return false;\n  }\n\n  /**\n   * *PMW*\n   */\n  public getCornerPoints(center: XY): GetCornerPointsResponse {\n    const angle = this.angle;\n    let width = this.getScaledWidth();\n    const height = this.getScaledHeight();\n    const x = center.x;\n    const y = center.y;\n    const theta = degreesToRadians(angle);\n\n    if (width < 0) {\n      width = Math.abs(width);\n    }\n\n    const sinTh = Math.sin(theta),\n      cosTh = Math.cos(theta),\n      _angle = width > 0 ? Math.atan(height / width) : 0,\n      _hypotenuse = width / Math.cos(_angle) / 2,\n      offsetX = Math.cos(_angle + theta) * _hypotenuse,\n      offsetY = Math.sin(_angle + theta) * _hypotenuse;\n\n    return {\n      tl: new Point(x - offsetX, y - offsetY),\n      tr: new Point(x - offsetX + width * cosTh, y - offsetY + width * sinTh),\n      bl: new Point(x - offsetX - height * sinTh, y - offsetY + height * cosTh),\n      br: new Point(x + offsetX, y + offsetY),\n    };\n  }\n\n  /**\n   * Converts an object into a data-url-like string\n   * @param {Object} options Options object\n   * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n   * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n   * @param {Number} [options.multiplier=1] Multiplier to scale by\n   * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n   * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n   * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n   * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n   * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n   * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n   * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n   * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\n   */\n  toDataURL(options: toDataURLOptions = {}) {\n    return toDataURL(\n      this.toCanvasElement(options),\n      options.format || 'png',\n      options.quality || 1,\n    );\n  }\n\n  /**\n   * Returns true if any of the specified types is identical to the type of an instance\n   * @param {String} type Type to check against\n   * @return {Boolean}\n   */\n  isType(...types: string[]) {\n    return (\n      types.includes((this.constructor as typeof FabricObject).type) ||\n      types.includes(this.type)\n    );\n  }\n\n  /**\n   * Returns complexity of an instance\n   * @return {Number} complexity of this instance (is 1 unless subclassed)\n   */\n  complexity() {\n    return 1;\n  }\n\n  /**\n   * Returns a JSON representation of an instance\n   * @return {Object} JSON\n   */\n  toJSON() {\n    // delegate, not alias\n    return this.toObject();\n  }\n\n  /**\n   * Sets \"angle\" of an instance with centered rotation\n   * @param {TDegree} angle Angle value (in degrees)\n   */\n  rotate(angle: TDegree) {\n    const { centeredRotation, originX, originY } = this;\n\n    if (centeredRotation) {\n      const { x, y } = this.getRelativeCenterPoint();\n      this.originX = CENTER;\n      this.originY = CENTER;\n      this.left = x;\n      this.top = y;\n    }\n\n    this.set('angle', angle);\n\n    if (centeredRotation) {\n      const { x, y } = this.translateToOriginPoint(\n        this.getRelativeCenterPoint(),\n        originX,\n        originY,\n      );\n      this.left = x;\n      this.top = y;\n      this.originX = originX;\n      this.originY = originY;\n    }\n  }\n\n  /**\n   * This callback function is called by the parent group of an object every\n   * time a non-delegated property changes on the group. It is passed the key\n   * and value as parameters. Not adding in this function's signature to avoid\n   * Travis build error about unused variables.\n   */\n  setOnGroup() {\n    // implemented by sub-classes, as needed.\n  }\n\n  /**\n   * Sets canvas globalCompositeOperation for specific object\n   * custom composition operation for the particular object can be specified using globalCompositeOperation property\n   * @param {CanvasRenderingContext2D} ctx Rendering canvas context\n   */\n  _setupCompositeOperation(ctx: CanvasRenderingContext2D) {\n    if (this.globalCompositeOperation) {\n      ctx.globalCompositeOperation = this.globalCompositeOperation;\n    }\n  }\n\n  /**\n   * cancel instance's running animations\n   * override if necessary to dispose artifacts such as `clipPath`\n   */\n  dispose() {\n    runningAnimations.cancelByTarget(this);\n    this.off();\n    this._set('canvas', undefined);\n    // clear caches\n    this._cacheCanvas && getEnv().dispose(this._cacheCanvas);\n    this._cacheCanvas = undefined;\n    this._cacheContext = null;\n  }\n\n  // #region Animation methods\n  /**\n   * List of properties to consider for animating colors.\n   * @type String[]\n   */\n  static colorProperties: string[] = [FILL, STROKE, 'backgroundColor'];\n\n  /**\n   * Animates object's properties\n   * @param {Record<string, number | number[] | TColorArg>} animatable map of keys and end values\n   * @param {Partial<AnimationOptions<T>>} options\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#animation}\n   * @return {Record<string, TAnimation<T>>} map of animation contexts\n   *\n   * As object — multiple properties\n   *\n   * object.animate({ left: ..., top: ... });\n   * object.animate({ left: ..., top: ... }, { duration: ... });\n   */\n  animate<T extends number | number[] | TColorArg>(\n    animatable: Record<string, T>,\n    options?: Partial<AnimationOptions<T>>,\n  ): Record<string, TAnimation<T>> {\n    return Object.entries(animatable).reduce(\n      (acc, [key, endValue]) => {\n        acc[key] = this._animate(key, endValue, options);\n        return acc;\n      },\n      {} as Record<string, TAnimation<T>>,\n    );\n  }\n\n  /**\n   * @private\n   * @param {String} key Property to animate\n   * @param {String} to Value to animate to\n   * @param {Object} [options] Options object\n   */\n  _animate<T extends number | number[] | TColorArg>(\n    key: string,\n    endValue: T,\n    options: Partial<AnimationOptions<T>> = {},\n  ): TAnimation<T> {\n    const path = key.split('.');\n    const propIsColor = (\n      this.constructor as typeof FabricObject\n    ).colorProperties.includes(path[path.length - 1]);\n    const { abort, startValue, onChange, onComplete } = options;\n    const animationOptions = {\n      ...options,\n      target: this,\n      // path.reduce... is the current value in case start value isn't provided\n      startValue:\n        startValue ?? path.reduce((deep: any, key) => deep[key], this),\n      endValue,\n      abort: abort?.bind(this),\n      onChange: (\n        value: number | number[] | string,\n        valueProgress: number,\n        durationProgress: number,\n      ) => {\n        path.reduce((deep: Record<string, any>, key, index) => {\n          if (index === path.length - 1) {\n            deep[key] = value;\n          }\n          return deep[key];\n        }, this);\n        onChange &&\n        // @ts-expect-error generic callback arg0 is wrong\n        onChange(value, valueProgress, durationProgress);\n      },\n      onComplete: (\n        value: number | number[] | string,\n        valueProgress: number,\n        durationProgress: number,\n      ) => {\n        this.setCoords();\n        onComplete &&\n        // @ts-expect-error generic callback arg0 is wrong\n        onComplete(value, valueProgress, durationProgress);\n      },\n    } as AnimationOptions<T>;\n\n    return (\n      propIsColor\n        ? animateColor(animationOptions as ColorAnimationOptions)\n        : animate(\n          animationOptions as ValueAnimationOptions | ArrayAnimationOptions,\n        )\n    ) as TAnimation<T>;\n  }\n\n  // #region Object stacking methods\n\n  /**\n   * A reference to the parent of the object\n   * Used to keep the original parent ref when the object has been added to an ActiveSelection, hence loosing the `group` ref\n   */\n  declare parent?: Group;\n\n  /**\n   * Checks if object is descendant of target\n   * Should be used instead of {@link Group.contains} or {@link StaticCanvas.contains} for performance reasons\n   * @param {TAncestor} target\n   * @returns {boolean}\n   */\n  isDescendantOf(target: TAncestor): boolean {\n    const { parent, group } = this;\n    return (\n      parent === target ||\n      group === target ||\n      // walk up\n      (!!parent && parent.isDescendantOf(target)) ||\n      (!!group && group !== parent && group.isDescendantOf(target))\n    );\n  }\n\n  /**\n   * @returns {Ancestors} ancestors (excluding `ActiveSelection`) from bottom to top\n   */\n  getAncestors(): Ancestors {\n    const ancestors: TAncestor[] = [];\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    let parent: TAncestor | undefined = this;\n    do {\n      parent = parent.parent;\n      parent && ancestors.push(parent);\n    } while (parent);\n    return ancestors as Ancestors;\n  }\n\n  /**\n   * Compare ancestors\n   *\n   * @param {StackedObject} other\n   * @returns {AncestryComparison} an object that represent the ancestry situation.\n   */\n  findCommonAncestors<T extends this>(other: T): AncestryComparison {\n    if (this === other) {\n      return {\n        fork: [],\n        otherFork: [],\n        common: [this, ...this.getAncestors()],\n      } as AncestryComparison;\n    }\n    const ancestors = this.getAncestors();\n    const otherAncestors = other.getAncestors();\n    //  if `this` has no ancestors and `this` is top ancestor of `other` we must handle the following case\n    if (\n      ancestors.length === 0 &&\n      otherAncestors.length > 0 &&\n      this === otherAncestors[otherAncestors.length - 1]\n    ) {\n      return {\n        fork: [],\n        otherFork: [\n          other,\n          ...otherAncestors.slice(0, otherAncestors.length - 1),\n        ],\n        common: [this],\n      } as AncestryComparison;\n    }\n    //  compare ancestors\n    for (let i = 0, ancestor; i < ancestors.length; i++) {\n      ancestor = ancestors[i];\n      if (ancestor === other) {\n        return {\n          fork: [this, ...ancestors.slice(0, i)],\n          otherFork: [],\n          common: ancestors.slice(i),\n        } as AncestryComparison;\n      }\n      for (let j = 0; j < otherAncestors.length; j++) {\n        if (this === otherAncestors[j]) {\n          return {\n            fork: [],\n            otherFork: [other, ...otherAncestors.slice(0, j)],\n            common: [this, ...ancestors],\n          } as AncestryComparison;\n        }\n        if (ancestor === otherAncestors[j]) {\n          return {\n            fork: [this, ...ancestors.slice(0, i)],\n            otherFork: [other, ...otherAncestors.slice(0, j)],\n            common: ancestors.slice(i),\n          } as AncestryComparison;\n        }\n      }\n    }\n    // nothing shared\n    return {\n      fork: [this, ...ancestors],\n      otherFork: [other, ...otherAncestors],\n      common: [],\n    } as AncestryComparison;\n  }\n\n  /**\n   *\n   * @param {StackedObject} other\n   * @returns {boolean}\n   */\n  hasCommonAncestors<T extends this>(other: T): boolean {\n    const commonAncestors = this.findCommonAncestors(other);\n    return commonAncestors && !!commonAncestors.common.length;\n  }\n\n  /**\n   *\n   * @param {FabricObject} other object to compare against\n   * @returns {boolean | undefined} if objects do not share a common ancestor or they are strictly equal it is impossible to determine which is in front of the other; in such cases the function returns `undefined`\n   */\n  isInFrontOf<T extends this>(other: T): boolean | undefined {\n    if (this === other) {\n      return undefined;\n    }\n    const ancestorData = this.findCommonAncestors(other);\n\n    if (ancestorData.fork.includes(other as any)) {\n      return true;\n    }\n    if (ancestorData.otherFork.includes(this as any)) {\n      return false;\n    }\n    // if there isn't a common ancestor, we take the canvas.\n    // if there is no canvas, there is nothing to compare\n    const firstCommonAncestor = ancestorData.common[0] || this.canvas;\n    if (!firstCommonAncestor) {\n      return undefined;\n    }\n    const headOfFork = ancestorData.fork.pop(),\n      headOfOtherFork = ancestorData.otherFork.pop(),\n      thisIndex = (firstCommonAncestor as TCollection)._objects.indexOf(\n        headOfFork as any,\n      ),\n      otherIndex = (firstCommonAncestor as TCollection)._objects.indexOf(\n        headOfOtherFork as any,\n      );\n    return thisIndex > -1 && thisIndex > otherIndex;\n  }\n\n  // #region Serialization\n  /**\n   * Define a list of custom properties that will be serialized when\n   * instance.toObject() gets called\n   */\n  static customProperties: string[] = [];\n\n  /**\n   * Returns an object representation of an instance\n   * @param {string[]} [propertiesToInclude] Any properties that you might want to additionally include in the output\n   * @return {Object} Object representation of an instance\n   */\n  toObject(propertiesToInclude: any[] = []): any {\n    const propertiesToSerialize = propertiesToInclude.concat(\n      FabricObject.customProperties,\n      (this.constructor as typeof FabricObject).customProperties || [],\n    );\n    let clipPathData: Partial<SerializedObjectProps> | undefined;\n    const NUM_FRACTION_DIGITS = config.NUM_FRACTION_DIGITS;\n    const {\n      clipPath,\n      fill,\n      stroke,\n      shadow,\n      strokeDashArray,\n      left,\n      top,\n      originX,\n      originY,\n      width,\n      height,\n      strokeWidth,\n      strokeLineCap,\n      strokeDashOffset,\n      strokeLineJoin,\n      strokeUniform,\n      strokeMiterLimit,\n      scaleX,\n      scaleY,\n      angle,\n      flipX,\n      flipY,\n      opacity,\n      visible,\n      backgroundColor,\n      fillRule,\n      paintFirst,\n      globalCompositeOperation,\n      skewX,\n      skewY,\n    } = this;\n    if (clipPath && !clipPath.excludeFromExport) {\n      clipPathData = clipPath.toObject(\n        propertiesToSerialize.concat('inverted', 'absolutePositioned'),\n      );\n    }\n    const toFixedBound = (val: number) => toFixed(val, NUM_FRACTION_DIGITS);\n    const object = {\n      ...pick(this, propertiesToSerialize as (keyof this)[]),\n      type: (this.constructor as typeof FabricObject).type,\n      version: VERSION,\n      originX,\n      originY,\n      left: toFixedBound(left),\n      top: toFixedBound(top),\n      width: toFixedBound(width),\n      height: toFixedBound(height),\n      fill: isSerializableFiller(fill) ? fill.toObject() : fill,\n      stroke: isSerializableFiller(stroke) ? stroke.toObject() : stroke,\n      strokeWidth: toFixedBound(strokeWidth),\n      strokeDashArray: strokeDashArray\n        ? strokeDashArray.concat()\n        : strokeDashArray,\n      strokeLineCap,\n      strokeDashOffset,\n      strokeLineJoin,\n      strokeUniform,\n      strokeMiterLimit: toFixedBound(strokeMiterLimit),\n      scaleX: toFixedBound(scaleX),\n      scaleY: toFixedBound(scaleY),\n      angle: toFixedBound(angle),\n      flipX,\n      flipY,\n      opacity: toFixedBound(opacity),\n      shadow: shadow ? shadow.toObject() : shadow,\n      visible,\n      backgroundColor,\n      fillRule,\n      paintFirst,\n      globalCompositeOperation,\n      skewX: toFixedBound(skewX),\n      skewY: toFixedBound(skewY),\n      ...(clipPathData ? { clipPath: clipPathData } : null),\n    };\n\n    return !this.includeDefaultValues\n      ? this._removeDefaultValues(object)\n      : object;\n  }\n\n  /**\n   * Returns (dataless) object representation of an instance\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n   * @return {Object} Object representation of an instance\n   */\n  toDatalessObject(propertiesToInclude?: any[]): any {\n    // will be overwritten by subclasses\n    return this.toObject(propertiesToInclude);\n  }\n\n  /**\n   * @private\n   * @param {Object} object\n   */\n  _removeDefaultValues<T extends object>(object: T): Partial<T> {\n    // getDefaults() ( get from static ownDefaults ) should win over prototype since anyway they get assigned to instance\n    // ownDefault vs prototype is swappable only if you change all the fabric objects consistently.\n    const defaults = (this.constructor as typeof FabricObject).getDefaults();\n    const hasStaticDefaultValues = Object.keys(defaults).length > 0;\n    const baseValues = hasStaticDefaultValues\n      ? defaults\n      : Object.getPrototypeOf(this);\n\n    return pickBy(object, (value, key) => {\n      if (key === LEFT || key === TOP || key === 'type') {\n        return true;\n      }\n      const baseValue = baseValues[key];\n      return (\n        value !== baseValue &&\n        // basically a check for [] === []\n        !(\n          Array.isArray(value) &&\n          Array.isArray(baseValue) &&\n          value.length === 0 &&\n          baseValue.length === 0\n        )\n      );\n    });\n  }\n\n  /**\n   * Returns a string representation of an instance\n   * @return {String}\n   */\n  toString() {\n    return `#<${(this.constructor as typeof FabricObject).type}>`;\n  }\n\n  /**\n   *\n   * @param {Function} klass\n   * @param {object} object\n   * @param {object} [options]\n   * @param {string} [options.extraParam] property to pass as first argument to the constructor\n   * @param {AbortSignal} [options.signal] handle aborting, see https://developer.mozilla.org/en-US/docs/Web/API/AbortController/signal\n   * @returns {Promise<FabricObject>}\n   */\n  static _fromObject<S extends FabricObject>(\n    { type, ...serializedObjectOptions }: Record<string, unknown>,\n    { extraParam, ...options }: Abortable & { extraParam?: string } = {},\n  ): Promise<S> {\n    return enlivenObjectEnlivables<any>(serializedObjectOptions, options).then(\n      (enlivedObjectOptions) => {\n        // from the resulting enlived options, extract options.extraParam to arg0\n        // to avoid accidental overrides later\n        if (extraParam) {\n          delete enlivedObjectOptions[extraParam];\n          return new this(\n            serializedObjectOptions[extraParam],\n            // @ts-expect-error different signature\n            enlivedObjectOptions,\n          );\n        } else {\n          return new this(enlivedObjectOptions);\n        }\n      },\n    ) as Promise<S>;\n  }\n\n  /**\n   *\n   * @param {object} object\n   * @param {object} [options]\n   * @param {AbortSignal} [options.signal] handle aborting, see https://developer.mozilla.org/en-US/docs/Web/API/AbortController/signal\n   * @returns {Promise<FabricObject>}\n   */\n  static fromObject<T extends TOptions<SerializedObjectProps>>(\n    object: T,\n    options?: Abortable,\n  ) {\n    return this._fromObject(object, options);\n  }\n}\n\nclassRegistry.setClass(FabricObject);\nclassRegistry.setClass(FabricObject, 'object');\n"],"names":["FabricObject","ObjectGeometry","getDefaults","ownDefaults","type","name","constructor","toLowerCase","value","log","options","_defineProperty","Object","assign","setOptions","_createCacheCanvas","_cacheCanvas","createCanvasElement","_cacheContext","getContext","_updateCacheCanvas","dirty","_limitCacheSize","dims","width","height","max","config","maxCacheSideLimit","min","minCacheSideLimit","perfLimitSizeTotal","ar","limX","limY","cache","limitDimsByArea","x","capValue","y","zoomX","capped","zoomY","_getCacheCanvasDimensions","objectScale","getTotalObjectScaling","dim","_getTransformedDimensions","skewX","skewY","neededX","scaleX","neededY","scaleY","ALIASING_LIMIT","canvas","context","minCacheSize","dimensionsChanged","zoomChanged","drawingWidth","drawingHeight","shouldRedraw","additionalWidth","additionalHeight","shouldResizeCanvas","canvasWidth","canvasHeight","sizeGrowing","sizeShrinking","isTextObject","path","getHeightOfLine","Math","ceil","setTransform","clearRect","cacheTranslationX","round","cacheTranslationY","translate","scale","arguments","length","undefined","_setOptions","transform","ctx","needFullTransform","group","_transformDone","contextTop","m","calcTransformMatrix","getObjectScaling","Point","abs","qrDecompose","zoom","getZoom","retina","getCanvasRetinaScaling","scalarMultiply","getObjectOpacity","opacity","_constrainScale","minScaleLimit","_set","key","SCALE_X","SCALE_Y","flipX","flipY","Shadow","isChanged","cacheProperties","includes","parent","stateProperties","isNotVisible","strokeWidth","visible","render","skipOffscreen","isOnScreen","save","_setupCompositeOperation","drawSelectionBackground","_setOpacity","_setShadow","shouldCache","renderCache","drawCacheOnCanvas","_removeCacheCanvas","drawObject","restore","_ctx","isCacheDirty","forClipping","parentClipPaths","hasStroke","stroke","hasFill","fill","needsItsOwnCache","paintFirst","STROKE","shadow","clipPath","ownCaching","objectCaching","isOnACache","willDrawShadow","offsetX","offsetY","drawClipPathOnCache","canvasWithClipPath","inverted","globalCompositeOperation","drawImage","originalFill","originalStroke","_setClippingProperties","_renderBackground","_render","_drawClipPath","createClipPathLayer","createCanvasElementFor","forEach","prevClipPath","push","absolutePositioned","invertTransform","skipCanvas","backgroundColor","leanBackground","fillStyle","beginPath","offset","leanBackgroundOffset","slant","yFix","moveTo","lineTo","closePath","_getNonTransformedDimensions","fillRect","_removeShadow","globalAlpha","_setStrokeStyles","decl","lineWidth","lineCap","strokeLineCap","lineDashOffset","strokeDashOffset","lineJoin","strokeLineJoin","miterLimit","strokeMiterLimit","isFiller","gradientUnits","gradientTransform","patternTransform","_applyPatternForTransformedGradient","strokeStyle","toLive","_applyPatternGradientTransform","_setFillStyles","_ref","_setLineDash","dashArray","setLineDash","retinaScaling","sx","sy","viewportTransform","iMatrix","multX","multY","scaling","nonScaling","shadowColor","color","shadowBlur","blur","browserShadowBlurConstant","shadowOffsetX","shadowOffsetY","filler","t","_renderPaintInOrder","_renderStroke","_renderFill","fillRule","affectStroke","strokeUniform","strokeDashArray","_pCtx$createPattern","pCanvas","pCtx","createPattern","_findCenterFromElement","left","top","clone","propertiesToInclude","objectForm","toObject","fromObject","cloneAsImage","canvasEl","toCanvasElement","ImageClass","classRegistry","getClass","origParams","saveObjectTransform","originalGroup","originalShadow","enableRetinaScaling","getDevicePixelRatio","multiplier","canvasProvider","el","StaticCanvas","renderOnAddRemove","withoutTransform","resetObjectTransform","withoutShadow","sendObjectToPlane","getViewportTransform","setCoords","boundingRect","getBoundingRect","shadowOffset","expandBoundingBoxByFont","isGroup","maxWidthToAdd","maxHeightToAdd","maxFontSize","_getMaxExpandedFontSizeFromTextChildren","format","setPositionByOrigin","CENTER","originalCanvas","_objects","set","destroy","getCornerPoints","center","angle","getScaledWidth","getScaledHeight","theta","degreesToRadians","sinTh","sin","cosTh","cos","_angle","atan","_hypotenuse","tl","tr","bl","br","toDataURL","quality","isType","_len","types","Array","_key","complexity","toJSON","rotate","centeredRotation","originX","originY","getRelativeCenterPoint","translateToOriginPoint","setOnGroup","dispose","runningAnimations","cancelByTarget","off","getEnv","animate","animatable","entries","reduce","acc","_ref2","endValue","_animate","split","propIsColor","colorProperties","abort","startValue","onChange","onComplete","animationOptions","_objectSpread","target","deep","bind","valueProgress","durationProgress","index","animateColor","isDescendantOf","getAncestors","ancestors","findCommonAncestors","other","fork","otherFork","common","otherAncestors","slice","i","ancestor","j","hasCommonAncestors","commonAncestors","isInFrontOf","ancestorData","firstCommonAncestor","headOfFork","pop","headOfOtherFork","thisIndex","indexOf","otherIndex","propertiesToSerialize","concat","customProperties","clipPathData","NUM_FRACTION_DIGITS","excludeFromExport","toFixedBound","val","toFixed","object","pick","version","VERSION","isSerializableFiller","includeDefaultValues","_removeDefaultValues","toDatalessObject","defaults","hasStaticDefaultValues","keys","baseValues","getPrototypeOf","pickBy","LEFT","TOP","baseValue","isArray","toString","_fromObject","_ref3","serializedObjectOptions","_objectWithoutProperties","_excluded","_ref4","extraParam","_excluded2","enlivenObjectEnlivables","then","enlivedObjectOptions","fabricObjectDefaultValues","FILL","setClass"],"mappings":"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"}